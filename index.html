'use client'

import { useState, useEffect } from 'react'
import { User, Lock, Eye, EyeOff, Play, Download, MessageCircle, Settings, LogOut, Home, HelpCircle, ChevronRight, ChevronLeft, Sparkles, Send } from 'lucide-react'

// Componente para o √≠cone de carregamento
const LoadingSpinner = () => (
  <div className="flex justify-center items-center p-4">
    <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-yellow-400"></div>
  </div>
);

export default function VeraoTurboApp() {
  const [isLoggedIn, setIsLoggedIn] = useState(true) // Mudan√ßa: usu√°rio j√° entra logado
  const [activeSection, setActiveSection] = useState('inicio')
  const [selectedContent, setSelectedContent] = useState(null)
  const [showPassword, setShowPassword] = useState(false)
  const [showForgotPassword, setShowForgotPassword] = useState(false)
  const [currentSlide, setCurrentSlide] = useState(0)
  const [formData, setFormData] = useState({
    name: '',
    email: '',
    password: ''
  })

  // Estado para configura√ß√µes do perfil
  const [profileData, setProfileData] = useState({
    nome: 'joao',
    telefone: '',
    idade: '20',
    sexo: 'Masculino',
    altura: '170',
    peso: '60'
  })

  // Estados para funcionalidades da Gemini API
  const [generatedPlan, setGeneratedPlan] = useState('');
  const [isGeneratingPlan, setIsGeneratingPlan] = useState(false);
  const [coachMessages, setCoachMessages] = useState([]);
  const [userMessage, setUserMessage] = useState('');
  const [isCoachReplying, setIsCoachReplying] = useState(false);
  const [showToast, setShowToast] = useState(false);
  const [toastMessage, setToastMessage] = useState('');


  // Dados do carrossel de treinos
  const heroSlides = [
    {
      id: 1,
      type: 'abdomen',
      title: 'Abd√¥men Definido',
      subtitle: 'Sua barriga tanquinho come√ßa aqui!',
      description: 'Exerc√≠cios intensivos para fortalecer o core e definir o abd√¥men em tempo recorde.',
      image: 'https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=1200&h=800&fit=crop',
      buttonText: 'Treinar Abd√¥men'
    },
    {
      id: 2,
      type: 'bumbum',
      title: 'Bumbum e Pernas',
      subtitle: 'Gl√∫teos de ferro e pernas poderosas!',
      description: 'Transforme seu corpo com exerc√≠cios espec√≠ficos para gl√∫teos e pernas tonificadas.',
      image: 'https://images.unsplash.com/photo-1518611012118-696072aa579a?w=1200&h=800&fit=crop',
      buttonText: 'Treinar Gl√∫teos'
    },
    {
      id: 3,
      type: 'massa',
      title: 'Ganho de Massa',
      subtitle: 'Construa m√∫sculos de verdade!',
      description: 'Protocolo completo para hipertrofia e ganho de massa muscular acelerado.',
      image: 'https://images.unsplash.com/photo-1581009146145-b5ef050c2e1e?w=1200&h=800&fit=crop',
      buttonText: 'Ganhar Massa'
    },
    {
      id: 4,
      type: 'definicao',
      title: 'Defini√ß√£o Extrema',
      subtitle: 'M√∫sculos definidos e corpo seco!',
      description: 'Treinos de alta intensidade para queimar gordura e definir cada m√∫sculo.',
      image: 'https://images.unsplash.com/photo-1549060279-7e168fcee0c2?w=1200&h=800&fit=crop',
      buttonText: 'Definir Corpo'
    }
  ]

  // Auto-slide do carrossel a cada 3 segundos
  useEffect(() => {
    const interval = setInterval(() => {
      setCurrentSlide((prev) => (prev + 1) % heroSlides.length)
    }, 3000)

    return () => clearInterval(interval)
  }, [heroSlides.length])

  // Dados simulados de conte√∫do
  const contentData = {
    abdomen: [
      { id: 1, title: 'Abd√¥men Definido - Aula 1', duration: '15 min', thumbnail: 'https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=400&h=225&fit=crop', type: 'video', description: 'Exerc√≠cios b√°sicos para fortalecer o core e definir o abd√¥men.' },
      { id: 2, title: 'Prancha Avan√ßada', duration: '12 min', thumbnail: 'https://images.unsplash.com/photo-1544367567-0f2fcb009e0b?w=400&h=225&fit=crop', type: 'video', description: 'Varia√ß√µes de prancha para m√°xima ativa√ß√£o abdominal.' },
      { id: 3, title: 'Guia Alimentar Abd√¥men', duration: 'PDF', thumbnail: 'https://images.unsplash.com/photo-1490645935967-10de6ba17061?w=400&h=225&fit=crop', type: 'pdf', description: 'Dicas nutricionais para potencializar os resultados.' }
    ],
    bumbum: [
      { id: 4, title: 'Gl√∫teos de Ferro - Aula 1', duration: '20 min', thumbnail: 'https://images.unsplash.com/photo-1518611012118-696072aa579a?w=400&h=225&fit=crop', type: 'video', description: 'Exerc√≠cios para fortalecer e definir gl√∫teos e pernas.' },
      { id: 5, title: 'Agachamento Perfeito', duration: '18 min', thumbnail: 'https://images.unsplash.com/photo-1574680096145-d05b474e2155?w=400&h=225&fit=crop', type: 'video', description: 'T√©cnica correta e varia√ß√µes do agachamento.' },
      { id: 6, title: 'Treino Pernas Completo', duration: '25 min', thumbnail: 'https://images.unsplash.com/photo-1571019614242-c5c5dee9f50b?w=400&h=225&fit=crop', type: 'video', description: 'Rotina completa para pernas e gl√∫teos.' }
    ],
    massa: [
      { id: 7, title: 'Hipertrofia Total - Aula 1', duration: '30 min', thumbnail: 'https://images.unsplash.com/photo-1581009146145-b5ef050c2e1e?w=400&h=225&fit=crop', type: 'video', description: 'Exerc√≠cios para ganho de massa muscular.' },
      { id: 8, title: 'Treino Upper Body', duration: '28 min', thumbnail: 'https://images.unsplash.com/photo-1583454110551-21f2fa2afe61?w=400&h=225&fit=crop', type: 'video', description: 'Foco em membros superiores para hipertrofia.' },
      { id: 9, title: 'Protocolo de Massa', duration: 'PDF', thumbnail: 'https://images.unsplash.com/photo-1532384748853-8f54a8f476e2?w=400&h=225&fit=crop', type: 'pdf', description: 'Guia completo para ganho de massa muscular.' },
      // NOVO CARD PARA TREINO UPPER BODY FEMININO
      { id: 108, title: 'üí™ Treino Membros Superiores Feminino', duration: '28 min', thumbnail: 'https://i.postimg.cc/6Qhg8WC2/Mulheres-mais-fortes-estudo-derruba-mito-do-sexo-fr-gil-definitivamente.jpg', type: 'video', description: 'Desenvolva for√ßa e defini√ß√£o nos membros superiores com foco na est√©tica feminina. Ideal para hipertrofia e tonifica√ß√£o.' },
    ],
    definicao: [
      { id: 10, title: 'Defini√ß√£o Extrema - Aula 1', duration: '22 min', thumbnail: 'https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=400&h=225&fit=crop', type: 'video', description: 'Treino intenso para defini√ß√£o muscular.' },
      { id: 11, title: 'HIIT Queima Gordura', duration: '15 min', thumbnail: 'https://images.unsplash.com/photo-1549060279-7e168fcee0c2?w=400&h=225&fit=crop', type: 'video', description: 'Treino intervalado de alta intensidade.' },
      { id: 12, title: 'Cardio Funcional', duration: '20 min', thumbnail: 'https://images.unsplash.com/photo-1517836357463-d25dfeac3438?w=400&h=225&fit=crop', type: 'video', description: 'Exerc√≠cios funcionais para defini√ß√£o.' }
    ]
  }
  
    // Fun√ß√£o para chamar a API Gemini
  const callGeminiAPI = async (prompt, systemInstruction) => {
    const apiKey = ""; // Deixe em branco, ser√° tratado pelo ambiente
    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;

    const payload = {
      contents: [{ parts: [{ text: prompt }] }],
    };

    if (systemInstruction) {
        payload.systemInstruction = { parts: [{ text: systemInstruction }] };
    }

    try {
      // Implementa√ß√£o de exponential backoff
      let response;
      let retries = 3;
      let delay = 1000;
      for (let i = 0; i < retries; i++) {
        response = await fetch(apiUrl, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload),
        });
        if (response.ok) break;
        if (response.status === 429) {
          await new Promise(resolve => setTimeout(resolve, delay));
          delay *= 2;
        } else {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
      }

      if (!response.ok) {
        throw new Error(`API request failed after ${retries} retries.`);
      }

      const result = await response.json();
      const text = result.candidates?.[0]?.content?.parts?.[0]?.text;
      if (!text) {
          throw new Error("No text found in API response.");
      }
      return text;

    } catch (error) {
      console.error("Erro ao chamar a API Gemini:", error);
      return "Desculpe, n√£o foi poss√≠vel processar sua solicita√ß√£o no momento. Tente novamente mais tarde.";
    }
  };

  const handleGeneratePlan = async () => {
    if (!profileData.idade || !profileData.sexo || !profileData.altura || !profileData.peso) {
        alert("Por favor, preencha todos os seus dados no perfil antes de gerar um plano.");
        setActiveSection('configuracoes');
        return;
    }
    setIsGeneratingPlan(true);
    setGeneratedPlan('');
    
    const systemInstruction = `Voc√™ √© um personal trainer de elite e nutricionista chamado 'Coach Turbo', especialista em criar planos de treino de alta performance para o app 'Ver√£o Turbo'. Seja profissional, t√©cnico e motivador.`;
    const prompt = `Com base no perfil do usu√°rio:
- Sexo: ${profileData.sexo}
- Idade: ${profileData.idade} anos
- Altura: ${profileData.altura} cm
- Peso: ${profileData.peso} kg

Crie um plano de treino semanal detalhado com o objetivo principal de defini√ß√£o muscular e queima de gordura. O usu√°rio √© iniciante.

**REGRAS DE FORMATA√á√ÉO E EMOJIS (OBRIGAT√ìRIO):**
1.  **N√ÉO use NENHUM markdown.** N√£o use asteriscos (*), travess√µes (-), barras (/), hashtags (#), ou pipes (|). A formata√ß√£o de tabela com pipes (como '| Exerc√≠cio | Dura√ß√£o |') est√° PROIBIDA. Use APENAS quebras de linha e numera√ß√£o simples (ex: "1. Agachamento").
2.  **Use os seguintes emojis** para ilustrar as atividades de forma relevante:
    * üí™: For√ßa / Muscula√ß√£o
    * üèãÔ∏è‚Äç‚ôÇÔ∏è: Treino de peso / Academia
    * üèãÔ∏è‚Äç‚ôÄÔ∏è: Muscula√ß√£o feminina
    * üèÉ‚Äç‚ôÇÔ∏è: Corrida / Cardio
    * üèÉ‚Äç‚ôÄÔ∏è: Corrida feminina
    * üö¥‚Äç‚ôÇÔ∏è: Bike / Spinning
    * üßò‚Äç‚ôÄÔ∏è: Alongamento / Equil√≠brio
    * ü§∏‚Äç‚ôÇÔ∏è: Treino funcional
    * üèãÔ∏è: Levantamento de peso
    * ü•á: Supera√ß√£o / Objetivo atingido
    * üî•: Treino pegado / Queima cal√≥rica
    * üí¶: Suor / Esfor√ßo
    * ü•¶: Alimenta√ß√£o saud√°vel
    * üçó: Prote√≠na
    * üïí: Hor√°rio de treino / Disciplina
    * ‚è±Ô∏è: Cron√¥metro / Tempo de execu√ß√£o
    * üìà: Progresso / Evolu√ß√£o
    * üéØ: Foco / Meta
    * ‚ö°: Energia / Explos√£o
    * üß†: Mente forte / Foco mental
    * ‚ù§Ô∏è‚Äçüî•: Motiva√ß√£o / Determina√ß√£o
    * ü©∏: Treino intenso / Pump
    * üèÖ: Conquista / Resultado
    * üßç‚Äç‚ôÇÔ∏è: Postura / Execu√ß√£o
    * ü¶µ: Treino de pernas / Leg day

**ESTRUTURA DO PLANO:**
1.  Ser estruturado dia por dia (Segunda-feira a Domingo).
2.  Incluir 2 dias de descanso (podendo ser descanso ativo, como üßò‚Äç‚ôÄÔ∏è Alongamento ou üèÉ‚Äç‚ôÄÔ∏è Caminhada leve).
3.  Para cada dia de treino, liste os exerc√≠cios (ex: "1. ü¶µ Agachamento Perfeito").
4.  Para cada exerc√≠cio, especifique o n√∫mero de s√©ries, repeti√ß√µes (ou tempo) e o tempo de descanso. (Ex: "3 s√©ries de 10 repeti√ß√µes, 45s de descanso").
5.  **REGRA DE ESPA√áAMENTO (MUITO IMPORTANTE):**
    * Adicione uma **linha em branco** (um 'enter') entre o t√≠tulo do dia e o aquecimento.
    * Adicione uma **linha em branco** entre o aquecimento e a lista de exerc√≠cios (antes do "1.").
    * Adicione uma **linha em branco** entre cada exerc√≠cio (ex: entre o "1." e o "2.").
    * Adicione **DUAS linhas em branco** antes de come√ßar o pr√≥ximo dia (ex: entre o √∫ltimo exerc√≠cio de Segunda e o t√≠tulo "TER√áAFEIRA").
6.  Finalize com uma breve nota motivacional e profissional. üéØüìà`;
    
    const plan = await callGeminiAPI(prompt, systemInstruction);
    
    // Limpeza do texto para remover caracteres indesejados, conforme solicitado
    let cleanedPlan = plan
      .replace(/[*]/g, '')     // Remove *
      .replace(/ - /g, ' ')     // Remove " - " (dash usado como separador/bullet)
      .replace(/\//g, ' ')     // Remove / (barra)
      .replace(/[#|]/g, '')     // Remove # e |
      .replace(/(:?)-+(:?)/g, ''); // Remove linhas de tabela :---, ---:, ---

    // A LINHA ABAIXO FOI REMOVIDA para permitir que a IA adicione linhas em branco para espa√ßamento.
    // cleanedPlan = cleanedPlan.split('\n').filter(line => line.trim() !== '').join('\n');

    setGeneratedPlan(cleanedPlan);
    setIsGeneratingPlan(false);
  };
  
  const handleSendMessage = async (e) => {
    e.preventDefault();
    if (!userMessage.trim()) return;

    const newMessages = [...coachMessages, { sender: 'user', text: userMessage }];
    setCoachMessages(newMessages);
    setUserMessage('');
    setIsCoachReplying(true);
    
    const systemInstruction = "Voc√™ √© o Coach Turbo, um assistente de IA amig√°vel, motivacional e especialista em fitness e nutri√ß√£o do app Ver√£o Turbo. Responda √†s perguntas dos usu√°rios de forma clara, segura e encorajadora. Sempre inclua um aviso para consultarem um profissional de sa√∫de antes de iniciar qualquer dieta ou programa de exerc√≠cios. Baseie suas respostas nos dados do usu√°rio fornecidos no in√≠cio do prompt.";

    // Injeta o contexto do perfil no prompt
    const contextPrompt = `Aqui est√£o os dados do usu√°rio:
- Sexo: ${profileData.sexo}
- Idade: ${profileData.idade} anos
- Altura: ${profileData.altura} cm
- Peso: ${profileData.peso} kg
- Telefone: ${profileData.telefone}

Pergunta do usu√°rio: "${userMessage}"`;

    const response = await callGeminiAPI(contextPrompt, systemInstruction);

    setCoachMessages([...newMessages, { sender: 'ai', text: response }]);
    setIsCoachReplying(false);
  };


  // Valida√ß√£o de senha
  const validatePassword = (password) => {
    return password.length >= 6
  }

  const handleLogin = (e) => {
    e.preventDefault()
    
    if (!formData.email || !formData.password) {
      alert('Por favor, preencha todos os campos.')
      return
    }

    if (!validatePassword(formData.password)) {
      alert('A senha deve ter pelo menos 6 caracteres.')
      return
    }

    // Simula√ß√£o de login
    setIsLoggedIn(true)
    alert('Login realizado com sucesso!')
  }

  const handleRegister = (e) => {
    e.preventDefault()
    
    if (!formData.name || !formData.email || !formData.password) {
      alert('Por favor, preencha todos os campos.')
      return
    }

    if (!validatePassword(formData.password)) {
      alert('A senha deve ter pelo menos 6 caracteres.')
      return
    }

    // Simula√ß√£o de cadastro
    setIsLoggedIn(true)
    alert('Cadastro realizado com sucesso!')
  }

  const handleForgotPassword = (e) => {
    e.preventDefault()
    
    if (!formData.email) {
      alert('Por favor, digite seu e-mail.')
      return
    }

    // Simula√ß√£o de recupera√ß√£o de senha
    alert(`Um link de recupera√ß√£o foi enviado para ${formData.email}`)
    setShowForgotPassword(false)
  }

  const openWhatsApp = () => {
    window.open('https://wa.me/5511999999999?text=Ol√°! Preciso de suporte com o Ver√£o Turbo.', '_blank')
  }

  const handleProfileChange = (field, value) => {
    setProfileData(prev => ({
      ...prev,
      [field]: value
    }))
  }

  const handleSaveProfile = (e) => {
    e.preventDefault()
    
    // L√≥gica para salvar perfil (simula√ß√£o)
    // alert('Perfil atualizado com sucesso!') // Removido
    
    // Mostrar notifica√ß√£o de sucesso
    setToastMessage('Perfil atualizado com sucesso!');
    setShowToast(true);

    // Esconder a notifica√ß√£o ap√≥s 3 segundos
    setTimeout(() => {
      setShowToast(false);
      setToastMessage('');
    }, 3000);
  }

  const handleSendWhatsApp = () => {
    if (!profileData.telefone) {
      setToastMessage('Por favor, preencha seu telefone no Perfil.');
      setShowToast(true);
      setTimeout(() => setShowToast(false), 3000);
      setActiveSection('configuracoes');
      return;
    }
    // Limpa o n√∫mero para garantir que est√° no formato correto
    const cleanPhone = profileData.telefone.replace(/\D/g, '');
    let phoneWithCountryCode = cleanPhone;
    
    // Adiciona o c√≥digo do Brasil (55) se n√£o estiver presente
    if (cleanPhone.length <= 11) { // Formatos 11999998888 ou 2199998888
       phoneWithCountryCode = `55${cleanPhone}`;
    }

    const encodedText = encodeURIComponent(generatedPlan);
    const whatsappUrl = `https://wa.me/${phoneWithCountryCode}?text=${encodedText}`;
    window.open(whatsappUrl, '_blank');
  };

  const handleSavePDF = () => {
    // Cria uma nova janela para impress√£o
    const planWindow = window.open('', '_blank');
    planWindow.document.write(`
      <html>
        <head>
          <title>Seu Plano de Treino - Ver√£o Turbo</title>
          <style>
            body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; line-height: 1.6; padding: 30px; }
            pre { 
              white-space: pre-wrap; 
              word-wrap: break-word; 
              font-family: monospace; 
              font-size: 14px; 
              background-color: #f9f9f9; 
              padding: 20px; 
              border-radius: 8px; 
              border: 1px solid #eee;
            }
            h1 { color: #f59e0b; border-bottom: 2px solid #f59e0b; padding-bottom: 10px; }
          </style>
        </head>
        <body>
          <h1>Seu Plano de Treino Personalizado</h1>
          <pre>${generatedPlan}</pre>
          <script>
            setTimeout(() => {
              window.print(); // Abre a caixa de di√°logo de impress√£o
            }, 500); // Espera 0.5s para renderizar
          </script>
        </body>
      </html>
    `);
    planWindow.document.close();
  };


  const nextSlide = () => {
    setCurrentSlide((prev) => (prev + 1) % heroSlides.length)
  }

  const prevSlide = () => {
    setCurrentSlide((prev) => (prev - 1 + heroSlides.length) % heroSlides.length)
  }

  const goToSlide = (index) => {
    setCurrentSlide(index)
  }

  if (selectedContent) {
    return (
      <div className="min-h-screen bg-black text-white">
        {/* Header */}
        <div className="bg-gray-900 p-4 flex items-center justify-between">
          <button
            onClick={() => setSelectedContent(null)}
            className="text-yellow-400 hover:text-yellow-300 transition-colors"
          >
            ‚Üê Voltar
          </button>
          <div className="flex items-center space-x-3">
            <img 
              src="https://k6hrqrxuu8obbfwn.public.blob.vercel-storage.com/temp/b916953d-abca-400c-8a02-0cba6ad3af57.png" 
              alt="Ver√£o Turbo Logo" 
              className="h-8 w-auto" 
            />
            <h1 className="text-xl font-bold text-yellow-400">VER√ÉO TURBO</h1>
          </div>
          <div></div>
        </div>

        {/* Content Detail */}
        <div className="p-6">
          <div className="max-w-4xl mx-auto">
            {/* Video Player */}
            <div className="relative bg-gray-900 rounded-2xl overflow-hidden mb-6">
              <img
                src={selectedContent.thumbnail}
                alt={selectedContent.title}
                className="w-full h-64 md:h-96 object-cover"
              />
              <div className="absolute inset-0 flex items-center justify-center">
                <button className="bg-yellow-400 text-black p-4 rounded-full hover:bg-yellow-500 transition-colors">
                  <Play className="w-8 h-8" />
                </button>
              </div>
            </div>

            {/* Content Info */}
            <div className="space-y-4">
              <h2 className="text-2xl font-bold">{selectedContent.title}</h2>
              <div className="flex items-center space-x-4 text-gray-400">
                <span>{selectedContent.duration}</span>
                <span>‚Ä¢</span>
                <span className="capitalize">{selectedContent.type}</span>
              </div>
              <p className="text-gray-300 leading-relaxed">{selectedContent.description}</p>

              {/* Action Buttons */}
              <div className="flex flex-wrap gap-4 pt-4">
                <button className="bg-yellow-400 text-black px-6 py-3 rounded-lg font-medium hover:bg-yellow-500 transition-colors flex items-center space-x-2">
                  <Play className="w-5 h-5" />
                  <span>Assistir</span>
                </button>
                {selectedContent.type === 'pdf' && (
                  <button className="bg-gray-800 text-white px-6 py-3 rounded-lg font-medium hover:bg-gray-700 transition-colors flex items-center space-x-2">
                    <Download className="w-5 h-5" />
                    <span>Download</span>
                  </button>
                )}
              </div>
            </div>
          </div>
        </div>
      </div>
    )
  }

  return (
    <div className="min-h-screen bg-black text-white flex relative"> {/* Adicionado relative aqui se n√£o estiver */}
      
      {/* Toast Notification */}
      {showToast && (
        <div className="fixed top-8 right-8 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50 transition-all duration-300">
          {toastMessage}
        </div>
      )}

      {/* Sidebar */}
      <div className="w-64 bg-black border-r border-gray-800 flex flex-col">
        {/* Logo */}
        <div className="p-6 border-b border-gray-800 flex justify-center">
          <img 
            src="https://k6hrqrxuu8obbfwn.public.blob.vercel-storage.com/temp/b916953d-abca-400c-8a02-0cba6ad3af57.png" 
            alt="Ver√£o Turbo Logo" 
            className="h-20 w-auto" 
          />
        </div>

        {/* Navigation */}
        <nav className="flex-1 p-4">
          <div className="space-y-2">
            <button
              onClick={() => setActiveSection('inicio')}
              className={`w-full flex items-center space-x-3 p-3 rounded-lg transition-colors ${
                activeSection === 'inicio' ? 'bg-yellow-400 text-black' : 'text-gray-300 hover:bg-gray-800'
              }`}
            >
              <Home className="w-5 h-5" />
              <span>In√≠cio</span>
            </button>
            
            <button
              onClick={() => setActiveSection('planoAI')}
              className={`w-full flex items-center space-x-3 p-3 rounded-lg transition-colors ${
                activeSection === 'planoAI' ? 'bg-yellow-400 text-black' : 'text-gray-300 hover:bg-gray-800'
              }`}
            >
              <Sparkles className="w-5 h-5" />
              <span>Plano de Treino AI</span>
            </button>

            <div className="pt-4">
              <p className="text-xs text-gray-500 uppercase tracking-wider mb-2 px-3">Treinos</p>
              <button
                onClick={() => setActiveSection('abdomen')}
                className={`w-full flex items-center justify-between p-3 rounded-lg transition-colors ${
                  activeSection === 'abdomen' ? 'bg-gray-800 text-yellow-400' : 'text-gray-300 hover:bg-gray-800'
                }`}
              >
                <span>Abd√¥men</span>
                <ChevronRight className="w-4 h-4" />
              </button>
              <button
                onClick={() => setActiveSection('bumbum')}
                className={`w-full flex items-center justify-between p-3 rounded-lg transition-colors ${
                  activeSection === 'bumbum' ? 'bg-gray-800 text-yellow-400' : 'text-gray-300 hover:bg-gray-800'
                }`}
              >
                <span>Bumbum e Pernas</span>
                <ChevronRight className="w-4 h-4" />
              </button>
              <button
                onClick={() => setActiveSection('massa')}
                className={`w-full flex items-center justify-between p-3 rounded-lg transition-colors ${
                  activeSection === 'massa' ? 'bg-gray-800 text-yellow-400' : 'text-gray-300 hover:bg-gray-800'
                }`}
              >
                <span>Ganho de Massa</span>
                <ChevronRight className="w-4 h-4" />
              </button>
              <button
                onClick={() => setActiveSection('definicao')}
                className={`w-full flex items-center justify-between p-3 rounded-lg transition-colors ${
                  activeSection === 'definicao' ? 'bg-gray-800 text-yellow-400' : 'text-gray-300 hover:bg-gray-800'
                }`}
              >
                <span>Defini√ß√£o</span>
                <ChevronRight className="w-4 h-4" />
              </button>
            </div>

            <div className="pt-4 border-t border-gray-800 mt-4">
               <button
                  onClick={() => setActiveSection('coachAI')}
                  className={`w-full flex items-center space-x-3 p-3 rounded-lg transition-colors ${
                    activeSection === 'coachAI' ? 'bg-yellow-400 text-black' : 'text-gray-300 hover:bg-gray-800'
                  }`}
                >
                  <MessageCircle className="w-5 h-5" />
                  <span>Coach AI</span>
                </button>
              <button
                onClick={() => setActiveSection('suporte')}
                className={`w-full flex items-center space-x-3 p-3 rounded-lg transition-colors ${
                  activeSection === 'suporte' ? 'bg-yellow-400 text-black' : 'text-gray-300 hover:bg-gray-800'
                }`}
              >
                <HelpCircle className="w-5 h-5" />
                <span>Suporte</span>
              </button>
              <button
                onClick={() => setActiveSection('configuracoes')}
                className={`w-full flex items-center space-x-3 p-3 rounded-lg transition-colors ${
                  activeSection === 'configuracoes' ? 'bg-yellow-400 text-black' : 'text-gray-300 hover:bg-gray-800'
                }`}
              >
                <User className="w-5 h-5" />
                <span>Perfil</span>
              </button>
            </div>
          </div>
        </nav>
      </div>

      {/* Main Content */}
      <div className="flex-1 overflow-y-auto">
        {activeSection === 'inicio' && (
          <div className="p-8">
            <div className="max-w-6xl mx-auto">
              <div className="mb-8">
                <h2 className="text-3xl font-bold mb-2">Bem-vindo(a) ao Ver√£o Turbo!</h2>
                <p className="text-xl text-yellow-400 font-medium">A sua transforma√ß√£o come√ßa aqui.</p>
              </div>

              {/* Hero Carousel */}
              <div className="mb-12">
                <div className="relative rounded-3xl overflow-hidden h-96 md:h-[500px] lg:h-[600px]">
                  <div className="relative w-full h-full">
                    <img
                      src={heroSlides[currentSlide].image}
                      alt={heroSlides[currentSlide].title}
                      className="w-full h-full object-cover transition-all duration-500"
                    />
                    <div className="absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent">
                      <div className="absolute bottom-0 left-0 right-0 p-8 md:p-12">
                        <h3 className="text-3xl md:text-4xl lg:text-5xl font-bold text-white mb-2">
                          {heroSlides[currentSlide].title}
                        </h3>
                        <p className="text-xl md:text-2xl text-yellow-400 font-semibold mb-4">
                          {heroSlides[currentSlide].subtitle}
                        </p>
                        <p className="text-lg md:text-xl text-gray-200 mb-6 max-w-2xl">
                          {heroSlides[currentSlide].description}
                        </p>
                        <button 
                          onClick={() => setActiveSection(heroSlides[currentSlide].type)}
                          className="bg-yellow-400 text-black px-8 py-4 rounded-xl font-bold text-lg hover:bg-yellow-500 transition-all transform hover:scale-105"
                        >
                          {heroSlides[currentSlide].buttonText}
                        </button>
                      </div>
                    </div>
                  </div>
                  <button onClick={prevSlide} className="absolute left-4 top-1/2 transform -translate-y-1/2 bg-black/50 hover:bg-black/70 text-white p-3 rounded-full transition-all"><ChevronLeft className="w-6 h-6" /></button>
                  <button onClick={nextSlide} className="absolute right-4 top-1/2 transform -translate-y-1/2 bg-black/50 hover:bg-black/70 text-white p-3 rounded-full transition-all"><ChevronRight className="w-6 h-6" /></button>
                  <div className="absolute bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-2">
                    {heroSlides.map((_, index) => (<button key={index} onClick={() => goToSlide(index)} className={`w-3 h-3 rounded-full transition-all ${index === currentSlide ? 'bg-yellow-400' : 'bg-white/50 hover:bg-white/70'}`} />))}
                  </div>
                </div>
              </div>
              
              <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                {[{ key: 'abdomen', title: 'Treino Abd√¥men', image: 'https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=400&h=300&fit=crop' }, { key: 'bumbum', title: 'Bumbum e Pernas', image: 'https://images.unsplash.com/photo-1518611012118-696072aa579a?w=400&h=300&fit=crop' }, { key: 'massa', title: 'Ganho de Massa', image: 'https://images.unsplash.com/photo-1581009146145-b5ef050c2e1e?w=400&h=300&fit=crop' }, { key: 'definicao', title: 'Defini√ß√£o', image: 'https://images.unsplash.com/photo-1549060279-7e168fcee0c2?w=400&h=300&fit=crop' }].map((category) => (<button key={category.key} onClick={() => setActiveSection(category.key)} className="bg-gray-900 rounded-2xl overflow-hidden hover:bg-gray-800 transition-all group transform hover:scale-105"><div className="relative"><img src={category.image} alt={category.title} className="w-full h-48 object-cover group-hover:scale-110 transition-transform duration-300" /><div className="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent flex items-end"><h3 className="text-white font-bold text-lg p-4 w-full text-center">{category.title}</h3></div></div></button>))}
              </div>
            </div>
          </div>
        )}
        
        {activeSection === 'planoAI' && (
            <div className="p-8">
                <div className="max-w-4xl mx-auto">
                    <h2 className="text-3xl font-bold mb-2 text-yellow-400">Plano de Treino Personalizado com IA</h2>
                    <p className="text-gray-300 mb-6">Receba um plano de treino semanal exclusivo, criado pela nossa IA com base nos seus dados de perfil.</p>
                    <div className="bg-gray-900 p-6 rounded-2xl text-center">
                        <button
                            onClick={handleGeneratePlan}
                            disabled={isGeneratingPlan}
                            className="bg-yellow-400 text-black px-8 py-4 rounded-xl font-bold text-lg hover:bg-yellow-500 transition-all transform hover:scale-105 disabled:bg-gray-500 disabled:cursor-not-allowed flex items-center justify-center mx-auto"
                        >
                            <Sparkles className="w-5 h-5 mr-2" />
                            {isGeneratingPlan ? 'Gerando seu plano...' : '‚ú® Gerar meu plano de treino'}
                        </button>
                        {isGeneratingPlan && <LoadingSpinner />}
                        {generatedPlan && (
                            <div className="mt-8 p-6 bg-black border border-gray-700 rounded-lg text-left whitespace-pre-wrap">
                                <h3 className="text-2xl font-bold mb-4 text-yellow-400">Seu Plano Semanal:</h3>
                                <p className="text-gray-200 leading-relaxed">{generatedPlan}</p>
                                
                                {/* Bot√µes de A√ß√£o P√≥s-Gera√ß√£o */}
                                <div className="mt-6 flex flex-col sm:flex-row justify-center gap-4">
                                  <button
                                    onClick={handleSendWhatsApp}
                                    className="bg-green-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-green-700 transition-colors flex items-center justify-center space-x-2"
                                  >
                                    <MessageCircle className="w-5 h-5" />
                                    <span>Enviar pelo WhatsApp</span>
                                  </button>
                                  <button
                                    onClick={handleSavePDF}
                                    className="bg-gray-700 text-white px-6 py-3 rounded-lg font-medium hover:bg-gray-600 transition-colors flex items-center justify-center space-x-2"
                                  >
                                    <Download className="w-5 h-5" />
                                    <span>Salvar como PDF</span>
                                  </button>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            </div>
        )}
        
        {activeSection === 'coachAI' && (
             <div className="p-8 h-full flex flex-col">
                <div className="max-w-4xl mx-auto w-full flex-grow flex flex-col">
                    <h2 className="text-3xl font-bold mb-2 text-yellow-400">Coach AI</h2>
                    <p className="text-gray-300 mb-6">Tem alguma d√∫vida sobre treino ou nutri√ß√£o? Pergunte ao nosso Coach AI!</p>
                    
                    <div className="bg-gray-900 p-6 rounded-2xl flex-grow flex flex-col">
                        <div className="flex-grow overflow-y-auto mb-4 space-y-4 pr-2">
                            {coachMessages.map((msg, index) => (
                                <div key={index} className={`flex ${msg.sender === 'user' ? 'justify-end' : 'justify-start'}`}>
                                    <div className={`max-w-md p-3 rounded-lg ${msg.sender === 'user' ? 'bg-yellow-400 text-black' : 'bg-gray-800 text-white'}`}>
                                        <p>{msg.text}</p>
                                    </div>
                                </div>
                            ))}
                             {isCoachReplying && (
                                <div className="flex justify-start">
                                    <div className="bg-gray-800 text-white p-3 rounded-lg">
                                       <LoadingSpinner />
                                    </div>
                                </div>
                            )}
                        </div>
                        <form onSubmit={handleSendMessage} className="flex items-center gap-4">
                            <input
                                type="text"
                                value={userMessage}
                                onChange={(e) => setUserMessage(e.target.value)}
                                placeholder="Digite sua pergunta..."
                                className="w-full p-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:border-yellow-400 focus:outline-none"
                            />
                            <button type="submit" className="bg-yellow-400 text-black p-3 rounded-lg hover:bg-yellow-500 transition-colors disabled:bg-gray-600" disabled={isCoachReplying}>
                                <Send className="w-6 h-6"/>
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        )}


        {(activeSection === 'abdomen' || activeSection === 'bumbum' || activeSection === 'massa' || activeSection === 'definicao') && (
          <div className="p-8">
            <div className="max-w-6xl mx-auto">
              <h2 className="text-3xl font-bold mb-8 capitalize">
                {activeSection === 'abdomen' && 'Treino para Abd√¥men'}
                {activeSection === 'bumbum' && 'Treino Bumbum e Pernas'}
                {activeSection === 'massa' && 'Ganho de Massa Muscular'}
                {activeSection === 'definicao' && 'Treino para Defini√ß√£o'}
              </h2>
              <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                {contentData[activeSection]?.map((content) => (<button key={content.id} onClick={() => setSelectedContent(content)} className="bg-gray-900 rounded-2xl overflow-hidden hover:bg-gray-800 transition-all group"><div className="relative"><img src={content.thumbnail} alt={content.title} className="w-full h-48 object-cover group-hover:scale-105 transition-transform" /><div className="absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity"><Play className="w-12 h-12 text-yellow-400" /></div><div className="absolute top-4 right-4 bg-black/70 px-2 py-1 rounded text-sm">{content.duration}</div></div><div className="p-4 text-left"><h3 className="font-semibold mb-2">{content.title}</h3><p className="text-gray-400 text-sm line-clamp-2">{content.description}</p></div></button>))}
              </div>
            </div>
          </div>
        )}

        {activeSection === 'suporte' && (
          <div className="p-8">
            <div className="max-w-4xl mx-auto">
              <h2 className="text-3xl font-bold mb-8">Suporte</h2>
              <div className="space-y-6">
                <div className="bg-gray-900 p-6 rounded-2xl"><h3 className="text-xl font-semibold mb-4">Contato Direto</h3><p className="text-gray-300 mb-4">Precisa de ajuda? Entre em contato conosco pelo WhatsApp para suporte personalizado.</p><button onClick={openWhatsApp} className="bg-green-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-green-700 transition-colors flex items-center space-x-2"><MessageCircle className="w-5 h-5" /><span>Abrir WhatsApp</span></button></div>
                <div className="bg-gray-900 p-6 rounded-2xl"><h3 className="text-xl font-semibold mb-4">Perguntas Frequentes</h3><div className="space-y-4"><div><h4 className="font-medium text-yellow-400 mb-2">Como acessar os treinos?</h4><p className="text-gray-300 text-sm">Use o menu lateral para navegar entre as categorias de treino. Clique em qualquer v√≠deo para assistir.</p></div><div><h4 className="font-medium text-yellow-400 mb-2">Posso baixar os PDFs?</h4><p className="text-gray-300 text-sm">Sim! Todos os materiais em PDF podem ser baixados para consulta offline.</p></div><div><h4 className="font-medium text-yellow-400 mb-2">Com que frequ√™ncia devo treinar?</h4><p className="text-gray-300 text-sm">Recomendamos 3-4 treinos por semana, alternando entre as diferentes categorias.</p></div></div></div>
              </div>
            </div>
          </div>
        )}

        {activeSection === 'configuracoes' && (
          <div className="p-8">
            <div className="max-w-4xl mx-auto">
              <h2 className="text-3xl font-bold mb-8 text-yellow-400">Perfil</h2>
              <form onSubmit={handleSaveProfile} className="space-y-6">
                <div className="bg-gray-900 p-6 rounded-2xl">
                  <h3 className="text-xl font-semibold mb-6 text-yellow-400">Perfil do Usu√°rio</h3>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                    <div><label className="block text-sm font-medium mb-2 text-white">Nome</label><input type="text" value={profileData.nome} onChange={(e) => handleProfileChange('nome', e.target.value)} className="w-full p-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:border-yellow-400 focus:outline-none" placeholder="Seu nome completo" /></div>
                    <div>
                      <label className="block text-sm font-medium mb-2 text-white">Telefone (com DDD)</label>
                      <input 
                        type="tel" 
                        value={profileData.telefone} 
                        onChange={(e) => handleProfileChange('telefone', e.target.value)} 
                        className="w-full p-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:border-yellow-400 focus:outline-none" 
                        placeholder="Ex: 11999998888" 
                      />
                    </div>
                  </div>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                    <div><label className="block text-sm font-medium mb-2 text-white">Idade</label><input type="number" value={profileData.idade} onChange={(e) => handleProfileChange('idade', e.target.value)} className="w-full p-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:border-yellow-400 focus:outline-none" placeholder="Sua idade" /></div>
                    <div><label className="block text-sm font-medium mb-2 text-white">Sexo</label><select value={profileData.sexo} onChange={(e) => handleProfileChange('sexo', e.target.value)} className="w-full p-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:border-yellow-400 focus:outline-none"><option value="">Selecione</option><option value="masculino">Masculino</option><option value="feminino">Feminino</option><option value="outro">Outro</option></select></div>
                  </div>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div><label className="block text-sm font-medium mb-2 text-white">Altura (cm)</label><input type="number" value={profileData.altura} onChange={(e) => handleProfileChange('altura', e.target.value)} className="w-full p-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:border-yellow-400 focus:outline-none" placeholder="Ex: 175" /></div>
                    <div><label className="block text-sm font-medium mb-2 text-white">Peso (kg)</label><input type="number" value={profileData.peso} onChange={(e) => handleProfileChange('peso', e.target.value)} className="w-full p-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:border-yellow-400 focus:outline-none" placeholder="Ex: 70" /></div>
                  </div>
                </div>
                <div className="text-center"><button type="submit" className="bg-yellow-400 text-black px-8 py-3 rounded-lg font-bold hover:bg-yellow-500 transition-colors">Salvar Altera√ß√µes</button></div>
              </form>
            </div>
          </div>
        )}
      </div>
    </div>
  )
}
